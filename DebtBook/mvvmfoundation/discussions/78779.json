[
  {
    "Id": "269688",
    "ThreadId": "78779",
    "Html": "<p>Hi,</p>\r\n<p>I have come up with an implementation of Messenger that might be interesting to you. I notice your messages are all strings, and the callback limited to a single parameter.</p>\r\n<p>Here's how mine looks:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">    public</span> <span style=\"color:Blue\">class</span> Messenger\r\n    {\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">void</span> Broadcast(<span style=\"color:Blue\">object</span> message); <span style=\"color:Green\">// aka NotifyColleagues</span>\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">void</span> Subscribe(Action handler); <span style=\"color:Green\">// aka Register</span>\r\n    }\r\n</pre>\r\n</div>\r\n<p>Here, a message can be any object, and clients register with the message type. The callback accepts a single parameter of the type of the message.</p>\r\n<p>An example message class:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">class</span> ShowOpenFileDialogMessage\r\n    {\r\n        <span style=\"color:Blue\">public</span> ShowOpenFileDialogMessage(<span style=\"color:Blue\">string</span> filter);\r\n        <span style=\"color:Blue\">public</span> ShowOpenFileDialogMessage(<span style=\"color:Blue\">string</span> filter, bool multiSelect);\r\n\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">string</span> Filter { <span style=\"color:Blue\">get</span>; <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">set</span>; }\r\n        <span style=\"color:Blue\">public</span> bool MultiSelect { <span style=\"color:Blue\">get</span>; <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">set</span>; }\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">string</span>[] Result { <span style=\"color:Blue\">get</span>; <span style=\"color:Blue\">set</span>; }\r\n    }\r\n</pre>\r\n</div>\r\n<p>It is subscribed to like this:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    messenger.Subscribe&lt;ShowOpenFileDialogMessage&gt;(ShowOpenFileDialog);\r\n</pre>\r\n</div>\r\n<p>With an implementation something like this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>        <span style=\"color:Blue\">void</span> ShowOpenFileDialog(ShowOpenFileDialogMessage message)\r\n        {\r\n            System.Windows.Forms.OpenFileDialog dialog = <span style=\"color:Blue\">new</span> System.Windows.Forms.OpenFileDialog();\r\n            dialog.Filter = message.Filter;\r\n            dialog.Multiselect = message.MultiSelect;\r\n\r\n            <span style=\"color:Blue\">if</span> (dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)\r\n            {\r\n                message.Result = dialog.FileNames;\r\n            }\r\n            <span style=\"color:Blue\">else</span>\r\n            {\r\n                message.Result = <span style=\"color:Blue\">null</span>;\r\n            }\r\n        }\r\n</pre>\r\n</div>\r\n<p>As you can see, the message can also return a value through the message parameter.</p>\r\n<p>Thoughts?</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-21T13:09:25.287-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "269689",
    "ThreadId": "78779",
    "Html": "<p>Oh! Almost forgot...</p>\r\n<p>Another thing I do to make it easier to use the messenger is to create extension methods (bodies of all but one method omitted):</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\"><span style=\"color:blue\">    public</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">class</span> MessengerExtensions\r\n    {\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> MessageBoxResult ShowError(<span style=\"color:blue\">this</span> MessengerService messenger, <span style=\"color:blue\">string</span> message);\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> MessageBoxResult ShowMessageBox(<span style=\"color:blue\">this</span> MessengerService messenger, <span style=\"color:blue\">string</span> message, <span style=\"color:blue\">string</span> caption, MessageBoxImage image, MessageBoxButton button);\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">string</span>[] ShowOpenFileDialog(<span style=\"color:blue\">this</span> MessengerService messenger, <span style=\"color:blue\">string</span> filter)\r\n        {\r\n            ShowOpenFileDialogMessage m = <span style=\"color:blue\">new</span> ShowOpenFileDialogMessage(filter);\r\n            messenger.Broadcast(m);\r\n            <span style=\"color:blue\">return</span> m.Result;\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">string</span>[] ShowOpenFileDialog(<span style=\"color:blue\">this</span> MessengerService messenger, <span style=\"color:blue\">string</span> filter, <span style=\"color:blue\">bool</span> multiSelect);\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> PrintDialog ShowPrintDialog(<span style=\"color:blue\">this</span> MessengerService messenger);\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">string</span> ShowSaveFileDialog(<span style=\"color:blue\">this</span> MessengerService messenger, <span style=\"color:blue\">string</span> filter);\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">string</span> ShowSaveFileDialog(<span style=\"color:blue\">this</span> MessengerService messenger, <span style=\"color:blue\">string</span> filter, <span style=\"color:blue\">string</span> defaultFileName);\r\n    }</pre>\r\n</div>\r\n<p>This makes, e.g. showing an error message box as simple as:</p>\r\n<p>&nbsp;</p>\r\n<pre>    messenger.ShowError(&quot;Error message...&quot;)</pre>\r\n<p>Easier than WinForms! ;)</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-21T13:13:56.85-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "273359",
    "ThreadId": "78779",
    "Html": "<p>Very interesting! &nbsp;Thanks for the food for thought. :)</p>",
    "PostedDate": "2010-01-05T08:32:28.957-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]